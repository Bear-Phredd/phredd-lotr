// Realtime Cloud Messaging JavaScript Library
// Copyright 2015, Realtime.co
//
// Visit us at framework.realtime.co and learn more.
//
// Date: Fri Jul 17 2015 15:21 v2.1.24

var IbtRealTimeSJType="IbtRealTimeSJ";function loadOrtcFactory(g,k){var a=new OrtcFactory(g);k(a,null)}function OrtcFactory(){this.createClient=function(){return new IbtRealTimeSJ}}
function OrtcError(g){this.code=g;switch(g){case 1:this.message="Was not possible to load the kaazing api";break;case 2:this.message="Was not possible to load the socket.io api";break;case 3:this.message="Is not possible to load more than one factory of each ORTC type";break;case 4:this.message="Unknown ORTC type";break;case 5:this.message="Pusher key is not defined";break;case 6:this.message="Was not possible to load the pusher api";break;default:this.message="Unknown error"}}
String.prototype.ortcTreatUrl=function(){var g=this;g&&(g=g.replace(/\s+/g,""),"/"==g.charAt(g.length-1)&&(g=g.substring(0,g.length-1)));return g};function ortcIsValidUrl(g){return/^\s*(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?\s*$/.exec(g)?!0:!1}function ortcIsValidInput(g){return/^[\w-:\/\.]*$/.exec(g)?!0:!1}function ortcIsValidBoolean(g){return/^(true|false|0|1)$/.exec(g)?!0:!1}function ortcIsFunction(g){return"function"==typeof g?!0:!1}
function ortcIsString(g){return"string"==typeof g?!0:!1}function ortcIsArray(g){return g instanceof Array}function ortcStrToArray(g){try{return g=g.replace(/[^\w,]/gi,""),0<g.length?g.split(","):[]}catch(k){return[]}}var _qevents=_qevents||[];(function(){var g=document,k=g.createElement("script"),a=g.getElementsByTagName("script")[0];k.src=("https:"===g.location.protocol?"https://secure":"http://edge")+".quantserve.com/quant.js";k.async=!0;k.type="text/javascript";a.parentNode.insertBefore(k,a)})();
_qevents.push({qacct:"p-HGAVM7nQJ_sep"});var JSON;JSON||(JSON={});
(function(){function g(a,D){var r,x,u,h,t=l,p,q=D[a];q&&"object"==typeof q&&"function"==typeof q.toJSON&&(q=q.toJSON(a));"function"==typeof z&&(q=z.call(D,a,q));switch(typeof q){case "string":return k(q);case "number":return isFinite(q)?String(q):"null";case "boolean":case "null":return String(q);case "object":if(!q)return"null";l+=C;p=[];if("[object Array]"===Object.prototype.toString.apply(q)){h=q.length;for(r=0;r<h;r+=1)p[r]=g(r,q)||"null";u=0===p.length?"[]":l?"[\n"+l+p.join(",\n"+l)+"\n"+t+"]":
"["+p.join(",")+"]";l=t;return u}if(z&&"object"==typeof z){h=z.length;for(r=0;r<h;r+=1)"string"==typeof z[r]&&(x=z[r],u=g(x,q),u&&p.push(k(x)+(l?": ":":")+u))}else for(x in q)Object.prototype.hasOwnProperty.call(q,x)&&(u=g(x,q),u&&p.push(k(x)+(l?": ":":")+u));u=0===p.length?"{}":l?"{\n"+l+p.join(",\n"+l)+"\n"+t+"}":"{"+p.join(",")+"}";l=t;return u}}function k(a){w.lastIndex=0;return w.test(a)?'"'+a.replace(w,function(a){var b=M[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+
'"':'"'+a+'"'}function a(a){return 10>a?"0"+a:a}"use strict";"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var B=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
w=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,l,C,M={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},z;"function"!=typeof JSON.stringify&&(JSON.stringify=function(a,k,r){var x;C=l="";if("number"==typeof r)for(x=0;x<r;x+=1)C+=" ";else"string"==typeof r&&(C=r);z=k;if(!k||"function"==typeof k||"object"==typeof k&&"number"==typeof k.length)return g("",{"":a});throw Error("JSON.stringify");});"function"!=
typeof JSON.parse&&(JSON.parse=function(a,g){function k(a,b){var l,p,q=a[b];if(q&&"object"==typeof q)for(l in q)Object.prototype.hasOwnProperty.call(q,l)&&(p=k(q,l),void 0!==p?q[l]=p:delete q[l]);return g.call(a,b,q)}var l,a=String(a);B.lastIndex=0;B.test(a)&&(a=a.replace(B,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return l=eval("("+a+")"),"function"==typeof g?k({"":l},""):l;throw new SyntaxError("JSON.parse");})})();
SockJS=function(){var g=document,k=window,a={},B=function(){};B.prototype.addEventListener=function(n,c){this._listeners||(this._listeners={});n in this._listeners||(this._listeners[n]=[]);var e=this._listeners[n];-1===a.arrIndexOf(e,c)&&e.push(c)};B.prototype.removeEventListener=function(n,c){if(this._listeners&&n in this._listeners){var e=this._listeners[n],d=a.arrIndexOf(e,c);-1!==d&&(1<e.length?this._listeners[n]=e.slice(0,d).concat(e.slice(d+1)):delete this._listeners[n])}};B.prototype.dispatchEvent=
function(n){var a=n.type,e=Array.prototype.slice.call(arguments,0);this["on"+a]&&this["on"+a].apply(this,e);if(this._listeners&&a in this._listeners)for(var d=0;d<this._listeners[a].length;d++)this._listeners[a][d].apply(this,e)};var w=function(n,a){this.type=n;if("undefined"!=typeof a)for(var e in a)a.hasOwnProperty(e)&&(this[e]=a[e])};w.prototype.toString=function(){var n=[],a;for(a in this)if(this.hasOwnProperty(a)){var e=this[a];"function"==typeof e&&(e="[function]");n.push(a+"="+e)}return"SimpleEvent("+
n.join(", ")+")"};var l=function(a){this.events=a||[]};l.prototype.emit=function(n){var c=Array.prototype.slice.call(arguments,1);!this.nuked&&this["on"+n]&&this["on"+n].apply(this,c);-1===a.arrIndexOf(this.events,n)&&a.log("Event "+JSON.stringify(n)+" not listed "+JSON.stringify(this.events)+" in "+this)};l.prototype.nuke=function(){this.nuked=!0;for(var a=0;a<this.events.length;a++)delete this[this.events[a]]};a.random_string=function(a,c){var c=c||37,e,d=[];for(e=0;e<a;e++)d.push("abcdefghijklmnopqrstuvwxyz0123456789_".substr(Math.floor(Math.random()*
c),1));return d.join("")};a.random_number=function(a){return Math.floor(Math.random()*a)};a.random_number_string=function(n){var c=(""+(n-1)).length;return(Array(c+1).join("0")+a.random_number(n)).slice(-c)};a.getOrigin=function(a){return(a+"/").split("/").slice(0,3).join("/")};a.isLocalUrl=function(a){var c=k.location.href.split("/").slice(0,3).join("/");return a.slice(0,c.length)===c};a.objectExtend=function(a,c){for(var e in c)c.hasOwnProperty(e)&&(a[e]=c[e]);return a};a.polluteGlobalNamespace=
function(){"_jp"in k||(k._jp={})};a.closeFrame=function(a,c){return"c"+JSON.stringify([a,c])};a.userSetCode=function(a){return 1E3===a||3E3<=a&&4999>=a};a.countRTO=function(a){var c;return 100<a?c=3*a:c=a+200,c};a.log=function(){k.console&&console.log&&console.log.apply&&console.log.apply(console,arguments)};a.bind=function(a,c){return a.bind?a.bind(c):function(){return a.apply(c,arguments)}};a.amendUrl=function(a){var c=g.location;if(!a)throw Error("Wrong url for SockJS");return 0===a.indexOf("//")&&
(a=c.protocol+a),0===a.indexOf("/")&&(a=c.protocol+"//"+c.host+a),a=a.replace(/[/]+$/,""),a};a.arrIndexOf=function(a,c){for(var e=0;e<a.length;e++)if(a[e]===c)return e;return-1};a.arrSkip=function(n,c){var e=a.arrIndexOf(n,c);return-1===e?n.slice():n.slice(0,e).concat(n.slice(e+1))};a.isArray=Array.isArray||function(a){return 0<={}.toString.call(a).indexOf("Array")};a.delay=function(a,c){return"function"==typeof a&&(c=a,a=0),setTimeout(c,a)};var C=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
M={"\x00":"\\u0000","\u0001":"\\u0001","\u0002":"\\u0002","\u0003":"\\u0003","\u0004":"\\u0004","\u0005":"\\u0005","\u0006":"\\u0006","\u0007":"\\u0007","\b":"\\b","\t":"\\t","\n":"\\n","\x0B":"\\u000b","\f":"\\f","\r":"\\r","\u000e":"\\u000e","\u000f":"\\u000f","\u0010":"\\u0010","\u0011":"\\u0011","\u0012":"\\u0012","\u0013":"\\u0013","\u0014":"\\u0014","\u0015":"\\u0015","\u0016":"\\u0016","\u0017":"\\u0017","\u0018":"\\u0018","\u0019":"\\u0019","\u001a":"\\u001a","\u001b":"\\u001b","\u001c":"\\u001c",
"\u001d":"\\u001d","\u001e":"\\u001e","\u001f":"\\u001f",'"':'\\"',"\\":"\\\\","\u007f":"\\u007f","\u0080":"\\u0080","\u0081":"\\u0081","\u0082":"\\u0082","\u0083":"\\u0083","\u0084":"\\u0084","\u0085":"\\u0085","\u0086":"\\u0086","\u0087":"\\u0087","\u0088":"\\u0088","\u0089":"\\u0089","\u008a":"\\u008a","\u008b":"\\u008b","\u008c":"\\u008c","\u008d":"\\u008d","\u008e":"\\u008e","\u008f":"\\u008f","\u0090":"\\u0090","\u0091":"\\u0091","\u0092":"\\u0092","\u0093":"\\u0093","\u0094":"\\u0094","\u0095":"\\u0095",
"\u0096":"\\u0096","\u0097":"\\u0097","\u0098":"\\u0098","\u0099":"\\u0099","\u009a":"\\u009a","\u009b":"\\u009b","\u009c":"\\u009c","\u009d":"\\u009d","\u009e":"\\u009e","\u009f":"\\u009f","\u00ad":"\\u00ad","\u0600":"\\u0600","\u0601":"\\u0601","\u0602":"\\u0602","\u0603":"\\u0603","\u0604":"\\u0604","\u070f":"\\u070f","\u17b4":"\\u17b4","\u17b5":"\\u17b5","\u200c":"\\u200c","\u200d":"\\u200d","\u200e":"\\u200e","\u200f":"\\u200f","\u2028":"\\u2028","\u2029":"\\u2029","\u202a":"\\u202a","\u202b":"\\u202b",
"\u202c":"\\u202c","\u202d":"\\u202d","\u202e":"\\u202e","\u202f":"\\u202f","\u2060":"\\u2060","\u2061":"\\u2061","\u2062":"\\u2062","\u2063":"\\u2063","\u2064":"\\u2064","\u2065":"\\u2065","\u2066":"\\u2066","\u2067":"\\u2067","\u2068":"\\u2068","\u2069":"\\u2069","\u206a":"\\u206a","\u206b":"\\u206b","\u206c":"\\u206c","\u206d":"\\u206d","\u206e":"\\u206e","\u206f":"\\u206f","\ufeff":"\\ufeff","\ufff0":"\\ufff0","\ufff1":"\\ufff1","\ufff2":"\\ufff2","\ufff3":"\\ufff3","\ufff4":"\\ufff4","\ufff5":"\\ufff5",
"\ufff6":"\\ufff6","\ufff7":"\\ufff7","\ufff8":"\\ufff8","\ufff9":"\\ufff9","\ufffa":"\\ufffa","\ufffb":"\\ufffb","\ufffc":"\\ufffc","\ufffd":"\\ufffd","\ufffe":"\\ufffe","\uffff":"\\uffff"},z=/[\x00-\x1f\ud800-\udfff\ufffe\uffff\u0300-\u0333\u033d-\u0346\u034a-\u034c\u0350-\u0352\u0357-\u0358\u035c-\u0362\u0374\u037e\u0387\u0591-\u05af\u05c4\u0610-\u0617\u0653-\u0654\u0657-\u065b\u065d-\u065e\u06df-\u06e2\u06eb-\u06ec\u0730\u0732-\u0733\u0735-\u0736\u073a\u073d\u073f-\u0741\u0743\u0745\u0747\u07eb-\u07f1\u0951\u0958-\u095f\u09dc-\u09dd\u09df\u0a33\u0a36\u0a59-\u0a5b\u0a5e\u0b5c-\u0b5d\u0e38-\u0e39\u0f43\u0f4d\u0f52\u0f57\u0f5c\u0f69\u0f72-\u0f76\u0f78\u0f80-\u0f83\u0f93\u0f9d\u0fa2\u0fa7\u0fac\u0fb9\u1939-\u193a\u1a17\u1b6b\u1cda-\u1cdb\u1dc0-\u1dcf\u1dfc\u1dfe\u1f71\u1f73\u1f75\u1f77\u1f79\u1f7b\u1f7d\u1fbb\u1fbe\u1fc9\u1fcb\u1fd3\u1fdb\u1fe3\u1feb\u1fee-\u1fef\u1ff9\u1ffb\u1ffd\u2000-\u2001\u20d0-\u20d1\u20d4-\u20d7\u20e7-\u20e9\u2126\u212a-\u212b\u2329-\u232a\u2adc\u302b-\u302c\uaab2-\uaab3\uf900-\ufa0d\ufa10\ufa12\ufa15-\ufa1e\ufa20\ufa22\ufa25-\ufa26\ufa2a-\ufa2d\ufa30-\ufa6d\ufa70-\ufad9\ufb1d\ufb1f\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufb4e\ufff0-\uffff]/g,
b,D=JSON&&JSON.stringify||function(a){return C.lastIndex=0,C.test(a)&&(a=a.replace(C,function(a){return M[a]})),'"'+a+'"'};a.quote=function(a){a=D(a);z.lastIndex=0;if(z.test(a)){if(!b){var c,e={},d=[];for(c=0;65536>c;c++)d.push(String.fromCharCode(c));b=(z.lastIndex=0,d.join("").replace(z,function(d){return e[d]="\\u"+("0000"+d.charCodeAt(0).toString(16)).slice(-4),""}),z.lastIndex=0,e)}a=a.replace(z,function(e){return b[e]})}return a};var r="websocket xdr-streaming xhr-streaming iframe-eventsource iframe-htmlfile xdr-polling xhr-polling iframe-xhr-polling jsonp-polling".split(" ");
a.probeProtocols=function(){for(var a={},c=0;c<r.length;c++){var e=r[c];a[e]=h[e]&&h[e].enabled()}return a};a.detectProtocols=function(a,c,e){var d={},s=[];c||(c=r);for(var f=0;f<c.length;f++){var m=c[f];d[m]=a[m]}var v=function(e){var a=e.shift();d[a]?s.push(a):0<e.length&&v(e)};return!1!==e.websocket&&v(["websocket"]),d["xdr-streaming"]&&!e.cookie_needed?s.push("xdr-streaming"):v(["xhr-streaming","iframe-eventsource","iframe-htmlfile"]),d["xdr-polling"]&&!e.cookie_needed?s.push("xdr-polling"):v(["xhr-polling",
"iframe-xhr-polling","jsonp-polling"]),s};a.createHook=function(){var n="a"+a.random_string(8);if(!("_sockjs_global"in k)){var c={};k._sockjs_global=function(e){return e in c||(c[e]={id:e,del:function(){delete c[e]}}),c[e]}}return k._sockjs_global(n)};a.attachMessage=function(n){a.attachEvent("message",n)};a.attachEvent=function(a,c){"undefined"!=typeof k.addEventListener?k.addEventListener(a,c,!1):(g.attachEvent("on"+a,c),k.attachEvent("on"+a,c))};a.detachMessage=function(n){a.detachEvent("message",
n)};a.detachEvent=function(a,c){"undefined"!=typeof k.addEventListener?k.removeEventListener(a,c,!1):(g.detachEvent("on"+a,c),k.detachEvent("on"+a,c))};var x={};a.unload_add=function(n){var c=a.random_string(8);return x[c]=n,c};a.unload_del=function(a){a in x&&delete x[a]};a.attachEvent("unload",function(){for(var a in x)x[a]()});a.createIframe=function(n,c){var e=g.createElement("iframe"),d,s=function(){clearTimeout(d);try{e.onload=null}catch(a){}e.onerror=null},f=function(){e&&(s(),e.src="about:blank",
setTimeout(function(){e&&e.parentNode.removeChild(e);e=null},0),a.detachEvent("unload",f))};return e.src=n,e.style.display="none",e.style.position="absolute",e.onerror=function(){e&&(f(),c("onerror"))},e.onload=function(){clearTimeout(d);d=setTimeout(function(){e&&(f(),c("onload timeout"))},2E3)},g.body.appendChild(e),d=setTimeout(function(){e&&(f(),c("timeout"))},5E3),a.attachEvent("unload",f),{iframe:e,cleanup:f,loaded:s}};a.createHtmlfile=function(n,c){var e=new ActiveXObject("htmlfile"),d,s,f=
function(){clearTimeout(d)},m=function(){if(e){f();a.detachEvent("unload",m);try{s.src="about:blank"}catch(d){}s.parentNode.removeChild(s);s=e=null;CollectGarbage()}};e.open();e.write('<html><script>document.domain="'+document.domain+'";<\/script></html>');e.close();e.parentWindow._jp=k._jp;var v=e.createElement("div");return e.body.appendChild(v),s=e.createElement("iframe"),v.appendChild(s),s.src=n,d=setTimeout(function(){e&&(m(),c("timeout"))},5E3),a.attachEvent("unload",m),{iframe:s,cleanup:m,
loaded:f}};var u=a.XHRObject=function(n,c,e){var d=this;a.delay(function(){d._start(n,c,e)})};u.prototype=new l(["chunk","finish"]);u.prototype._start=function(n,c,e){var d=this;if(k.ActiveXObject){c+=(-1===c.indexOf("?")?"?":"&")+"t="+ +new Date;try{d.xhr=new ActiveXObject("Microsoft.XMLHTTP")}catch(s){}}d.xhr||(d.xhr=new XMLHttpRequest);d.unload_ref=a.unload_add(function(){d._cleanup(!0)});try{d.xhr.open(n,c,!0)}catch(f){d.emit("finish",0,"");d._cleanup();return}"withCredentials"in d.xhr&&(d.xhr.withCredentials=
"true");d.xhr.onreadystatechange=function(){if(d.xhr){var e=d.xhr;switch(e.readyState){case 3:try{d.emit("chunk",e.status,e.responseText)}catch(a){}break;case 4:d.emit("finish",e.status,e.responseText),d._cleanup(!1)}}};d.xhr.send(e)};u.prototype._cleanup=function(n){if(this.xhr){a.unload_del(this.unload_ref);this.xhr.onreadystatechange=function(){};if(n)try{this.xhr.abort()}catch(c){}this.unload_ref=this.xhr=null}};u.prototype.close=function(){this.nuke();this._cleanup(!0)};u=a.XDRObject=function(n,
c,e){var d=this;a.delay(function(){d._start(n,c,e)})};u.prototype=new l(["chunk","finish"]);u.prototype._start=function(n,c,e){var d=this,s=new XDomainRequest,c=c+((-1===c.indexOf("?")?"?":"&")+"t="+ +new Date),f=s.ontimeout=s.onerror=function(){d.emit("finish",0,"");d._cleanup(!1)};s.onprogress=function(){d.emit("chunk",200,s.responseText)};s.onload=function(){d.emit("finish",200,s.responseText);d._cleanup(!1)};d.xdr=s;d.unload_ref=a.unload_add(function(){d._cleanup(!0)});try{d.xdr.open(n,c),d.xdr.send(e)}catch(m){f()}};
u.prototype._cleanup=function(n){if(this.xdr){a.unload_del(this.unload_ref);this.xdr.ontimeout=this.xdr.onerror=this.xdr.onprogress=this.xdr.onload=null;if(n)try{this.xdr.abort()}catch(c){}this.unload_ref=this.xdr=null}};u.prototype.close=function(){this.nuke();this._cleanup(!0)};a.isXHRCorsCapable=function(){return k.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest?1:k.XDomainRequest?2:A.enabled()?3:4};var h=function(n,c,e){var d=this,s;d._options={devel:!1,debug:!1,protocols_whitelist:[],
info:void 0,rtt:void 0};e&&a.objectExtend(d._options,e);d._base_url=a.amendUrl(n);d._server=d._options.server||a.random_number_string(1E3);d._options.protocols_whitelist&&d._options.protocols_whitelist.length?s=d._options.protocols_whitelist:("string"==typeof c&&0<c.length?s=[c]:a.isArray(c)?s=c:s=null,s&&d._debug('Deprecated API: Use "protocols_whitelist" option instead of supplying protocol list as a second parameter to SockJS constructor.'));d._protocols=[];d.protocol=null;d.readyState=h.CONNECTING;
S(d._base_url).onfinish=function(e,a){e?(d._options.info&&(e=d._options.info),d._options.rtt&&(a=d._options.rtt),d._applyInfo(e,a,s),d._didClose()):d._didClose(1002,"Can't connect to server",!0)}};h.prototype=new B;h.version="0.2.1";h.CONNECTING=0;h.OPEN=1;h.CLOSING=2;h.CLOSED=3;h.prototype._debug=function(){this._options.debug&&a.log.apply(a,arguments)};h.prototype._dispatchOpen=function(){this.readyState===h.CONNECTING?(this._transport_tref&&(clearTimeout(this._transport_tref),this._transport_tref=
null),this.readyState=h.OPEN,this.dispatchEvent(new w("open"))):this._didClose(1006,"Server lost session")};h.prototype._dispatchMessage=function(a){this.readyState===h.OPEN&&this.dispatchEvent(new w("message",{data:a}))};h.prototype._dispatchHeartbeat=function(){this.readyState===h.OPEN&&this.dispatchEvent(new w("heartbeat",{}))};h.prototype._didClose=function(n,c,e){var d=this;if(d.readyState!==h.CONNECTING&&d.readyState!==h.OPEN&&d.readyState!==h.CLOSING)throw Error("INVALID_STATE_ERR");d._transport&&
d._transport.doCleanup();d._transport=null;var s=new w("close",{code:n,reason:c,wasClean:a.userSetCode(n)});if(!a.userSetCode(n)&&d.readyState===h.CONNECTING&&!e){if(d._try_next_protocol(s))return;s=new w("close",{code:2E3,reason:"All transports failed",wasClean:!1,last_event:s})}d.readyState=h.CLOSED;a.delay(function(){d.dispatchEvent(s)})};h.prototype._didMessage=function(a){switch(a.slice(0,1)){case "o":this._dispatchOpen();break;case "a":for(var a=JSON.parse(a.slice(1)||"[]"),c=0;c<a.length;c++)this._dispatchMessage(a[c]);
break;case "m":a=JSON.parse(a.slice(1)||"null");this._dispatchMessage(a);break;case "c":a=JSON.parse(a.slice(1)||"[]");this._didClose(a[0],a[1]);break;case "h":this._dispatchHeartbeat()}};h.prototype._try_next_protocol=function(n){var c=this;c.protocol&&(c._debug("Closed transport:",c.protocol,""+n),c.protocol=null);for(c._transport_tref&&(clearTimeout(c._transport_tref),c._transport_tref=null);;){n=c.protocol=c._protocols.shift();if(!n)return!1;if(h[n]&&!0===h[n].need_body&&!g.body)return c._protocols.unshift(n),
c.protocol="waiting-for-load",a.attachEvent("load",function(){c._try_next_protocol()}),!0;if(!h[n]||!h[n].enabled(c._options))c._debug("Skipping transport:",n);else{c._transport_tref=a.delay((c._options.rto||0)*(h[n].roundTrips||1)||5E3,function(){c.readyState===h.CONNECTING&&c._didClose(2007,"Transport timeouted")});var e=a.random_string(8),e=c._base_url+"/"+c._server+"/"+e;return c._debug("Opening transport:",n," url:"+e," RTO:"+c._options.rto),c._transport=new h[n](c,e,c._base_url),!0}}};h.prototype.close=
function(n,c){if(n&&!a.userSetCode(n))throw Error("INVALID_ACCESS_ERR");return this.readyState!==h.CONNECTING&&this.readyState!==h.OPEN?!1:(this.readyState=h.CLOSING,this._didClose(n||1E3,c||"Normal closure"),!0)};h.prototype.send=function(n){if(this.readyState===h.CONNECTING)throw Error("INVALID_STATE_ERR");return this.readyState===h.OPEN&&this._transport.doSend(a.quote(""+n)),!0};h.prototype._applyInfo=function(n,c,e){this._options.info=n;this._options.rtt=c;this._options.rto=a.countRTO(c);c=a.probeProtocols();
this._protocols=a.detectProtocols(c,e,n)};u=h.websocket=function(n,c){var e=this,d=c+"/websocket";"https"===d.slice(0,5)?d="wss"+d.slice(5):d="ws"+d.slice(4);e.ri=n;e.url=d;e.ws=new (k.WebSocket||k.MozWebSocket)(e.url);e.ws.onmessage=function(a){e.ri._didMessage(a.data)};e.unload_ref=a.unload_add(function(){e.ws.close()});e.ws.onclose=function(){e.ri._didMessage(a.closeFrame(1006,"WebSocket connection broken"))}};u.prototype.doSend=function(a){this.ws.send(a)};u.prototype.doCleanup=function(){var n=
this.ws;n&&(n.onmessage=n.onclose=null,n.close(),a.unload_del(this.unload_ref),this.unload_ref=this.ri=this.ws=null)};u.enabled=function(){return!!k.WebSocket||!!k.MozWebSocket};var t=function(){};t.prototype.send_constructor=function(a){this.send_buffer=[];this.sender=a};t.prototype.doSend=function(a){this.send_buffer.push(a);this.send_stop||this.send_schedule()};t.prototype.send_schedule_wait=function(){var n=this,c;n.send_stop=function(){n.send_stop=null;clearTimeout(c)};c=a.delay(25,function(){n.send_stop=
null;n.send_schedule()})};t.prototype.send_schedule=function(){var a=this;if(0<a.send_buffer.length){var c="["+a.send_buffer.join(",")+"]";a.send_stop=a.sender(a.trans_url,c,function(){a.send_stop=null;a.send_schedule_wait()});a.send_buffer=[]}};t.prototype.send_destructor=function(){this._send_stop&&this._send_stop();this._send_stop=null};var p=function(b,c,e){if(!("_send_form"in this)){var d=this._send_form=g.createElement("form"),s=this._send_area=g.createElement("textarea");s.name="d";d.style.display=
"none";d.style.position="absolute";d.method="POST";d.enctype="application/x-www-form-urlencoded";d.acceptCharset="UTF-8";d.appendChild(s);g.body.appendChild(d)}var d=this._send_form,s=this._send_area,f="a"+a.random_string(8);d.target=f;d.action=b+"/jsonp_send?i="+f;var m;try{m=g.createElement('<iframe name="'+f+'">')}catch(v){m=g.createElement("iframe"),m.name=f}m.id=f;d.appendChild(m);m.style.display="none";try{s.value=c}catch(y){alert("Your browser is seriously broken. Go home! "+y.message)}d.submit();
var h=function(){m.onerror&&(m.onreadystatechange=m.onerror=m.onload=null,a.delay(500,function(){m.parentNode.removeChild(m);m=null}),s.value=null,e())};return m.onerror=m.onload=h,m.onreadystatechange=function(){"complete"==m.readyState&&h()},h},q=function(a){return function(c,e,d){return(new a("POST",c+"/xhr_send",e)).onfinish=function(e){d(e)},function(e){d(0,e)}}},u=h["jsonp-polling"]=function(b,c){a.polluteGlobalNamespace();this.ri=b;this.trans_url=c;this.send_constructor(p);this._schedule_recv()};
u.prototype=new t;u.prototype._schedule_recv=function(){var b=this,c=b.trans_url+"/jsonp",e="a"+a.random_string(6),c=c+"?c="+escape("_jp."+e),d=function(a){delete k._jp[e];b._recv_stop=null;a&&(b._is_closing||b.ri._didMessage(a));b._is_closing||b._schedule_recv()},s,f=g.createElement("script"),m,v=function(e){m&&(m.parentNode.removeChild(m),m=null);f&&(clearTimeout(s),f.parentNode.removeChild(f),f.onreadystatechange=f.onerror=f.onload=f.onclick=null,f=null,d(e),d=null)},y=!1,h=null;f.id="a"+a.random_string(8);
f.src=c;f.type="text/javascript";f.charset="UTF-8";f.onerror=function(){h||(h=setTimeout(function(){y||v(a.closeFrame(1006,"JSONP script loaded abnormally (onerror)"))},1E3))};f.onload=function(){v(a.closeFrame(1006,"JSONP script loaded abnormally (onload)"))};f.onreadystatechange=function(){if(/loaded|closed/.test(f.readyState)){if(f&&f.htmlFor&&f.onclick){y=!0;try{f.onclick()}catch(e){}}f&&v(a.closeFrame(1006,"JSONP script loaded abnormally (onreadystatechange)"))}};if("undefined"==typeof f.async&&
g.attachEvent)if(/opera/i.test(navigator.userAgent))m=g.createElement("script"),m.text="try{var a = document.getElementById('"+f.id+"'); if(a)a.onerror();}catch(x){};",f.async=m.async=!1;else{try{f.htmlFor=f.id,f.event="onclick"}catch(l){}f.async=!0}"undefined"!=typeof f.async&&(f.async=!0);s=setTimeout(function(){v(a.closeFrame(1006,"JSONP script loaded abnormally (timeout)"))},35E3);c=g.getElementsByTagName("head")[0];c=(c.insertBefore(f,c.firstChild),m&&c.insertBefore(m,c.firstChild),v);k._jp[e]=
c;b._recv_stop=function(){k._jp[e]&&k._jp[e](a.closeFrame(1E3,"JSONP user aborted read"))}};u.enabled=function(){return!0};u.need_body=!0;u.prototype.doCleanup=function(){this._is_closing=!0;this._recv_stop&&this._recv_stop();this.ri=this._recv_stop=null;this.send_destructor()};u=function(){};u.prototype=new t;u.prototype.run=function(a,c,e,d,s){this.ri=a;this.trans_url=c;this.send_constructor(q(s));this.poll=new P(a,d,c+e,s)};u.prototype.doCleanup=function(){this.poll&&(this.poll.abort(),this.poll=
null)};var E=h["xhr-streaming"]=function(b,c){this.run(b,c,"/xhr_streaming",J,a.XHRObject)};E.prototype=new u;E.enabled=function(){return k.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest};E.roundTrips=2;t=h["xdr-streaming"]=function(b,c){this.run(b,c,"/xhr_streaming",J,a.XDRObject)};t.prototype=new u;t.enabled=function(){return!!k.XDomainRequest};t.roundTrips=2;var I=h["xhr-polling"]=function(b,c){this.run(b,c,"/xhr",J,a.XHRObject)};I.prototype=new u;I.enabled=E.enabled;I.roundTrips=2;E=h["xdr-polling"]=
function(b,c){this.run(b,c,"/xhr",J,a.XDRObject)};E.prototype=new u;E.enabled=t.enabled;E.roundTrips=2;var A=function(){};A.prototype.i_constructor=function(b,c,e){var d=this;d.ri=b;d.origin=a.getOrigin(e);d.base_url=e;d.trans_url=c;b=e+"/iframe.html";d.ri._options.devel&&(b+="?t="+ +new Date);d.window_id=a.random_string(8);b+="#"+d.window_id;d.iframeObj=a.createIframe(b,function(e){d.ri._didClose(1006,"Unable to load an iframe ("+e+")")});d.onmessage_cb=a.bind(d.onmessage,d);a.attachMessage(d.onmessage_cb)};
A.prototype.doCleanup=function(){if(this.iframeObj){a.detachMessage(this.onmessage_cb);try{this.iframeObj.iframe.contentWindow&&this.postMessage("c")}catch(b){}this.iframeObj.cleanup();this.onmessage_cb=this.iframeObj=this.iframeObj=null}};A.prototype.onmessage=function(a){if(a.origin===this.origin){var c=a.data.slice(0,8),e=a.data.slice(8,9),a=a.data.slice(9);if(c===this.window_id)switch(e){case "s":this.iframeObj.loaded();this.postMessage("s",JSON.stringify([h.version,this.protocol,this.trans_url,
this.base_url]));break;case "t":this.ri._didMessage(a)}}};A.prototype.postMessage=function(a,c){this.iframeObj.iframe.contentWindow.postMessage(this.window_id+a+(c||""),this.origin)};A.prototype.doSend=function(a){this.postMessage("m",a)};A.enabled=function(){var a=navigator&&navigator.userAgent&&-1!==navigator.userAgent.indexOf("Konqueror");return("function"==typeof k.postMessage||"object"==typeof k.postMessage)&&!a};var Q,F=function(b,c){parent!==k?parent.postMessage(Q+b+(c||""),"*"):a.log("Can't postMessage, no parent window.",
b,c)},G=function(){};G.prototype._didClose=function(b,c){F("t",a.closeFrame(b,c))};G.prototype._didMessage=function(a){F("t",a)};G.prototype._doSend=function(a){this._transport.doSend(a)};G.prototype._doCleanup=function(){this._transport.doCleanup()};h.bootstrap_iframe=function(){var b;Q=g.location.hash.slice(1);a.attachMessage(function(c){if(c.source===parent){var e=c.data.slice(0,8),d=c.data.slice(8,9),c=c.data.slice(9);if(e===Q)switch(d){case "s":var s=JSON.parse(c),e=s[0],d=s[1],c=s[2],s=s[3];
e!==h.version&&a.log('Incompatibile SockJS! Main site uses: "'+e+'", the iframe: "'+h.version+'".');if(!a.isLocalUrl(c)||!a.isLocalUrl(s)){a.log("Can't connect to different domain from within an iframe. ("+JSON.stringify([k.location.href,c,s])+")");break}b=new G;b._transport=new G[d](b,c,s);break;case "m":b._doSend(c);break;case "c":b&&b._doCleanup(),b=null}}});F("s")};var L=function(b,c){var e=this;a.delay(function(){e.doXhr(b,c)})};L.prototype=new l(["finish"]);L.prototype.doXhr=function(b,c){var e=
this,d=(new Date).getTime(),s=new c("GET",b+"/info",null),f=a.delay(8E3,function(){s.ontimeout()});s.onfinish=function(a,b){clearTimeout(f);f=null;if(200===a){var s=(new Date).getTime()-d,c=JSON.parse(b);"object"!=typeof c&&(c={});e.emit("finish",c,s)}else e.emit("finish")};s.ontimeout=function(){s.close();e.emit("finish")}};var H=function(b){var c=this,e=function(){var e=new A;e.protocol="w-iframe-info-receiver";var a=function(a){"string"==typeof a&&"m"===a.substr(0,1)?(a=JSON.parse(a.substr(1)),
c.emit("finish",a[0],a[1])):c.emit("finish");e.doCleanup();e=null};e.i_constructor({_options:{},_didClose:a,_didMessage:a},b,b)};g.body?e():a.attachEvent("load",e)};H.prototype=new l(["finish"]);var K=function(){var b=this;a.delay(function(){b.emit("finish",{},2E3)})};K.prototype=new l(["finish"]);var S=function(b){if(a.isLocalUrl(b))return new L(b,a.XHRObject);switch(a.isXHRCorsCapable()){case 1:return new L(b,a.XHRObject);case 2:return new L(b,a.XDRObject);case 3:return new H(b);default:return new K}};
(G["w-iframe-info-receiver"]=function(b,c,e){(new L(e,a.XHRObject)).onfinish=function(e,a){b._didMessage("m"+JSON.stringify([e,a]));b._didClose()}}).prototype.doCleanup=function(){};l=h["iframe-eventsource"]=function(){this.protocol="w-iframe-eventsource";this.i_constructor.apply(this,arguments)};l.prototype=new A;l.enabled=function(){return"EventSource"in k&&A.enabled()};l.need_body=!0;l.roundTrips=3;(G["w-iframe-eventsource"]=function(b,c){this.run(b,c,"/eventsource",R,a.XHRObject)}).prototype=
new u;l=h["iframe-xhr-polling"]=function(){this.protocol="w-iframe-xhr-polling";this.i_constructor.apply(this,arguments)};l.prototype=new A;l.enabled=function(){return k.XMLHttpRequest&&A.enabled()};l.need_body=!0;l.roundTrips=3;(G["w-iframe-xhr-polling"]=function(b,c){this.run(b,c,"/xhr",J,a.XHRObject)}).prototype=new u;l=h["iframe-htmlfile"]=function(){this.protocol="w-iframe-htmlfile";this.i_constructor.apply(this,arguments)};l.prototype=new A;l.enabled=function(){return A.enabled()};l.need_body=
!0;l.roundTrips=3;(G["w-iframe-htmlfile"]=function(b,c){this.run(b,c,"/htmlfile",N,a.XHRObject)}).prototype=new u;var P=function(a,b,e,d){this.ri=a;this.Receiver=b;this.recv_url=e;this.AjaxObject=d;this._scheduleRecv()};P.prototype._scheduleRecv=function(){var a=this,b=a.poll=new a.Receiver(a.recv_url,a.AjaxObject);b.onmessage=function(e){a.ri._didMessage(e.data)};b.onclose=function(e){a.poll=b=b.onmessage=b.onclose=null;a.poll_is_closing||("permanent"===e.reason?a.ri._didClose(1006,"Polling error ("+
e.reason+")"):a._scheduleRecv())}};P.prototype.abort=function(){this.poll_is_closing=!0;this.poll&&this.poll.abort()};var R=function(b){var c=this,e=new EventSource(b);e.onmessage=function(e){c.dispatchEvent(new w("message",{data:unescape(e.data)}))};c.es_close=e.onerror=function(d,b){var f=b?"user":2!==e.readyState?"network":"permanent";c.es_close=e.onmessage=e.onerror=null;e.close();e=null;a.delay(200,function(){c.dispatchEvent(new w("close",{reason:f}))})}};R.prototype=new B;R.prototype.abort=
function(){this.es_close&&this.es_close({},!0)};var O,N=function(b){var c=this;a.polluteGlobalNamespace();c.id="a"+a.random_string(6,26);b+=(-1===b.indexOf("?")?"?":"&")+"c="+escape("_jp."+c.id);if(void 0===O)if("ActiveXObject"in k)try{O=!!new ActiveXObject("htmlfile")}catch(e){}else O=!1;var d=O?a.createHtmlfile:a.createIframe,s;k._jp[c.id]={start:function(){s.loaded()},message:function(e){c.dispatchEvent(new w("message",{data:e}))},stop:function(){c.iframe_close({},"network")}};c.iframe_close=function(e,
a){s.cleanup();c.iframe_close=s=null;delete k._jp[c.id];c.dispatchEvent(new w("close",{reason:a}))};s=d(b,function(){c.iframe_close({},"permanent")})};N.prototype=new B;N.prototype.abort=function(){this.iframe_close&&this.iframe_close({},"user")};var J=function(a,b){var e=this,d=0;e.xo=new b("POST",a,null);e.xo.onchunk=function(a,b){if(200===a)for(;;){var m=b.slice(d),c=m.indexOf("\n");if(-1===c)break;d+=c+1;m=m.slice(0,c);e.dispatchEvent(new w("message",{data:m}))}};e.xo.onfinish=function(a,d){e.xo.onchunk(a,
d);e.xo=null;e.dispatchEvent(new w("close",{reason:200===a?"network":"permanent"}))}};return J.prototype=new B,J.prototype.abort=function(){this.xo&&(this.xo.close(),this.dispatchEvent(new w("close",{reason:"user"})),this.xo=null)},h.getUtils=function(){return a},h.getIframeTransport=function(){return A},h}();"_sockjs_onload"in window&&setTimeout(_sockjs_onload,1);JSON||(JSON={});
(function(){function g(a,w){var r,x,u,h,t=l,p,q=w[a];q&&"object"==typeof q&&"function"==typeof q.toJSON&&(q=q.toJSON(a));"function"==typeof z&&(q=z.call(w,a,q));switch(typeof q){case "string":return k(q);case "number":return isFinite(q)?String(q):"null";case "boolean":case "null":return String(q);case "object":if(!q)return"null";l+=C;p=[];if("[object Array]"===Object.prototype.toString.apply(q)){h=q.length;for(r=0;r<h;r+=1)p[r]=g(r,q)||"null";u=0===p.length?"[]":l?"[\n"+l+p.join(",\n"+l)+"\n"+t+"]":
"["+p.join(",")+"]";l=t;return u}if(z&&"object"==typeof z){h=z.length;for(r=0;r<h;r+=1)"string"==typeof z[r]&&(x=z[r],u=g(x,q),u&&p.push(k(x)+(l?": ":":")+u))}else for(x in q)Object.prototype.hasOwnProperty.call(q,x)&&(u=g(x,q),u&&p.push(k(x)+(l?": ":":")+u));u=0===p.length?"{}":l?"{\n"+l+p.join(",\n"+l)+"\n"+t+"}":"{"+p.join(",")+"}";l=t;return u}}function k(a){w.lastIndex=0;return w.test(a)?'"'+a.replace(w,function(a){var b=M[a];return"string"==typeof b?b:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+
'"':'"'+a+'"'}function a(a){return 10>a?"0"+a:a}"use strict";"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+a(this.getUTCMonth()+1)+"-"+a(this.getUTCDate())+"T"+a(this.getUTCHours())+":"+a(this.getUTCMinutes())+":"+a(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(){return this.valueOf()});var B=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
w=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,l,C,M={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},z;"function"!=typeof JSON.stringify&&(JSON.stringify=function(a,k,r){var x;C=l="";if("number"==typeof r)for(x=0;x<r;x+=1)C+=" ";else"string"==typeof r&&(C=r);z=k;if(!k||"function"==typeof k||"object"==typeof k&&"number"==typeof k.length)return g("",{"":a});throw Error("JSON.stringify");});"function"!=
typeof JSON.parse&&(JSON.parse=function(a,g){function k(a,b){var l,p,q=a[b];if(q&&"object"==typeof q)for(l in q)Object.prototype.hasOwnProperty.call(q,l)&&(p=k(q,l),void 0!==p?q[l]=p:delete q[l]);return g.call(a,b,q)}var l,a=String(a);B.lastIndex=0;B.test(a)&&(a=a.replace(B,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return l=eval("("+a+")"),"function"==typeof g?k({"":l},""):l;throw new SyntaxError("JSON.parse");})})();
SockJS=function(){var g=document,k=window,a={},B=function(){};B.prototype.addEventListener=function(e,d){this._listeners||(this._listeners={});e in this._listeners||(this._listeners[e]=[]);var b=this._listeners[e];-1===a.arrIndexOf(b,d)&&b.push(d)};B.prototype.removeEventListener=function(e,d){if(this._listeners&&e in this._listeners){var b=this._listeners[e],f=a.arrIndexOf(b,d);-1!==f&&(1<b.length?this._listeners[e]=b.slice(0,f).concat(b.slice(f+1)):delete this._listeners[e])}};B.prototype.dispatchEvent=
function(e){var a=e.type,b=Array.prototype.slice.call(arguments,0);this["on"+a]&&this["on"+a].apply(this,b);if(this._listeners&&a in this._listeners)for(var f=0;f<this._listeners[a].length;f++)this._listeners[a][f].apply(this,b)};var w=function(a,d){this.type=a;if("undefined"!==typeof d)for(var b in d)d.hasOwnProperty(b)&&(this[b]=d[b])};w.prototype.toString=function(){var a=[],d;for(d in this)if(this.hasOwnProperty(d)){var b=this[d];"function"===typeof b&&(b="[function]");a.push(d+"="+b)}return"SimpleEvent("+
a.join(", ")+")"};var l=function(a){this.events=a||[]};l.prototype.emit=function(e){var d=Array.prototype.slice.call(arguments,1);!this.nuked&&this["on"+e]&&this["on"+e].apply(this,d);-1===a.arrIndexOf(this.events,e)&&a.log("Event "+JSON.stringify(e)+" not listed "+JSON.stringify(this.events)+" in "+this)};l.prototype.nuke=function(){this.nuked=!0;for(var a=0;a<this.events.length;a++)delete this[this.events[a]]};a.random_string=function(a,d){var d=d||37,b,f=[];for(b=0;b<a;b++)f.push("abcdefghijklmnopqrstuvwxyz0123456789_".substr(Math.floor(Math.random()*
d),1));return f.join("")};a.random_number=function(a){return Math.floor(Math.random()*a)};a.random_number_string=function(e){var d=(""+(e-1)).length;return(Array(d+1).join("0")+a.random_number(e)).slice(-d)};a.getOrigin=function(a){return(a+"/").split("/").slice(0,3).join("/")};a.isSameOriginUrl=function(a,d){d||(d=k.location.href);return a.split("/").slice(0,3).join("/")===d.split("/").slice(0,3).join("/")};a.getParentDomain=function(a){return/^[0-9.]*$/.test(a)||/^\[/.test(a)||!/[.]/.test(a)?a:
a.split(".").slice(1).join(".")};a.objectExtend=function(a,d){for(var b in d)d.hasOwnProperty(b)&&(a[b]=d[b]);return a};a.polluteGlobalNamespace=function(){"_jp"in k||(k._jp={})};a.closeFrame=function(a,d){return"c"+JSON.stringify([a,d])};a.userSetCode=function(a){return 1E3===a||3E3<=a&&4999>=a};a.countRTO=function(a){return 100<a?3*a:a+200};a.log=function(){k.console&&(console.log&&console.log.apply)&&console.log.apply(console,arguments)};a.bind=function(a,d){return a.bind?a.bind(d):function(){return a.apply(d,
arguments)}};a.flatUrl=function(a){return-1===a.indexOf("?")&&-1===a.indexOf("#")};a.amendUrl=function(e){var d=g.location;if(!e)throw Error("Wrong url for SockJS");if(!a.flatUrl(e))throw Error("Only basic urls are supported in SockJS");0===e.indexOf("//")&&(e=d.protocol+e);0===e.indexOf("/")&&(e=d.protocol+"//"+d.host+e);return e=e.replace(/[/]+$/,"")};a.arrIndexOf=function(a,d){for(var b=0;b<a.length;b++)if(a[b]===d)return b;return-1};a.arrSkip=function(e,d){var b=a.arrIndexOf(e,d);return-1===b?
e.slice():e.slice(0,b).concat(e.slice(b+1))};a.isArray=Array.isArray||function(a){return 0<={}.toString.call(a).indexOf("Array")};a.delay=function(a,d){"function"===typeof a&&(d=a,a=0);return setTimeout(d,a)};var C=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,M={"\x00":"\\u0000","\u0001":"\\u0001","\u0002":"\\u0002","\u0003":"\\u0003","\u0004":"\\u0004","\u0005":"\\u0005","\u0006":"\\u0006","\u0007":"\\u0007","\b":"\\b",
"\t":"\\t","\n":"\\n","\x0B":"\\u000b","\f":"\\f","\r":"\\r","\u000e":"\\u000e","\u000f":"\\u000f","\u0010":"\\u0010","\u0011":"\\u0011","\u0012":"\\u0012","\u0013":"\\u0013","\u0014":"\\u0014","\u0015":"\\u0015","\u0016":"\\u0016","\u0017":"\\u0017","\u0018":"\\u0018","\u0019":"\\u0019","\u001a":"\\u001a","\u001b":"\\u001b","\u001c":"\\u001c","\u001d":"\\u001d","\u001e":"\\u001e","\u001f":"\\u001f",'"':'\\"',"\\":"\\\\","\u007f":"\\u007f","\u0080":"\\u0080","\u0081":"\\u0081","\u0082":"\\u0082",
"\u0083":"\\u0083","\u0084":"\\u0084","\u0085":"\\u0085","\u0086":"\\u0086","\u0087":"\\u0087","\u0088":"\\u0088","\u0089":"\\u0089","\u008a":"\\u008a","\u008b":"\\u008b","\u008c":"\\u008c","\u008d":"\\u008d","\u008e":"\\u008e","\u008f":"\\u008f","\u0090":"\\u0090","\u0091":"\\u0091","\u0092":"\\u0092","\u0093":"\\u0093","\u0094":"\\u0094","\u0095":"\\u0095","\u0096":"\\u0096","\u0097":"\\u0097","\u0098":"\\u0098","\u0099":"\\u0099","\u009a":"\\u009a","\u009b":"\\u009b","\u009c":"\\u009c","\u009d":"\\u009d",
"\u009e":"\\u009e","\u009f":"\\u009f","\u00ad":"\\u00ad","\u0600":"\\u0600","\u0601":"\\u0601","\u0602":"\\u0602","\u0603":"\\u0603","\u0604":"\\u0604","\u070f":"\\u070f","\u17b4":"\\u17b4","\u17b5":"\\u17b5","\u200c":"\\u200c","\u200d":"\\u200d","\u200e":"\\u200e","\u200f":"\\u200f","\u2028":"\\u2028","\u2029":"\\u2029","\u202a":"\\u202a","\u202b":"\\u202b","\u202c":"\\u202c","\u202d":"\\u202d","\u202e":"\\u202e","\u202f":"\\u202f","\u2060":"\\u2060","\u2061":"\\u2061","\u2062":"\\u2062","\u2063":"\\u2063",
"\u2064":"\\u2064","\u2065":"\\u2065","\u2066":"\\u2066","\u2067":"\\u2067","\u2068":"\\u2068","\u2069":"\\u2069","\u206a":"\\u206a","\u206b":"\\u206b","\u206c":"\\u206c","\u206d":"\\u206d","\u206e":"\\u206e","\u206f":"\\u206f","\ufeff":"\\ufeff","\ufff0":"\\ufff0","\ufff1":"\\ufff1","\ufff2":"\\ufff2","\ufff3":"\\ufff3","\ufff4":"\\ufff4","\ufff5":"\\ufff5","\ufff6":"\\ufff6","\ufff7":"\\ufff7","\ufff8":"\\ufff8","\ufff9":"\\ufff9","\ufffa":"\\ufffa","\ufffb":"\\ufffb","\ufffc":"\\ufffc","\ufffd":"\\ufffd",
"\ufffe":"\\ufffe","\uffff":"\\uffff"},z=/[\x00-\x1f\ud800-\udfff\ufffe\uffff\u0300-\u0333\u033d-\u0346\u034a-\u034c\u0350-\u0352\u0357-\u0358\u035c-\u0362\u0374\u037e\u0387\u0591-\u05af\u05c4\u0610-\u0617\u0653-\u0654\u0657-\u065b\u065d-\u065e\u06df-\u06e2\u06eb-\u06ec\u0730\u0732-\u0733\u0735-\u0736\u073a\u073d\u073f-\u0741\u0743\u0745\u0747\u07eb-\u07f1\u0951\u0958-\u095f\u09dc-\u09dd\u09df\u0a33\u0a36\u0a59-\u0a5b\u0a5e\u0b5c-\u0b5d\u0e38-\u0e39\u0f43\u0f4d\u0f52\u0f57\u0f5c\u0f69\u0f72-\u0f76\u0f78\u0f80-\u0f83\u0f93\u0f9d\u0fa2\u0fa7\u0fac\u0fb9\u1939-\u193a\u1a17\u1b6b\u1cda-\u1cdb\u1dc0-\u1dcf\u1dfc\u1dfe\u1f71\u1f73\u1f75\u1f77\u1f79\u1f7b\u1f7d\u1fbb\u1fbe\u1fc9\u1fcb\u1fd3\u1fdb\u1fe3\u1feb\u1fee-\u1fef\u1ff9\u1ffb\u1ffd\u2000-\u2001\u20d0-\u20d1\u20d4-\u20d7\u20e7-\u20e9\u2126\u212a-\u212b\u2329-\u232a\u2adc\u302b-\u302c\uaab2-\uaab3\uf900-\ufa0d\ufa10\ufa12\ufa15-\ufa1e\ufa20\ufa22\ufa25-\ufa26\ufa2a-\ufa2d\ufa30-\ufa6d\ufa70-\ufad9\ufb1d\ufb1f\ufb2a-\ufb36\ufb38-\ufb3c\ufb3e\ufb40-\ufb41\ufb43-\ufb44\ufb46-\ufb4e\ufff0-\uffff]/g,
b,D=JSON&&JSON.stringify||function(a){C.lastIndex=0;C.test(a)&&(a=a.replace(C,function(a){return M[a]}));return'"'+a+'"'};a.quote=function(a){a=D(a);z.lastIndex=0;if(!z.test(a))return a;if(!b){var d,c={},f=[];for(d=0;65536>d;d++)f.push(String.fromCharCode(d));z.lastIndex=0;f.join("").replace(z,function(a){c[a]="\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4);return""});z.lastIndex=0;b=c}return a.replace(z,function(a){return b[a]})};var r="websocket xdr-streaming xhr-streaming iframe-eventsource iframe-htmlfile xdr-polling xhr-polling iframe-xhr-polling jsonp-polling".split(" ");
a.probeProtocols=function(){for(var a={},d=0;d<r.length;d++){var b=r[d];a[b]=p[b]&&p[b].enabled()}return a};a.detectProtocols=function(a,d,b){var f={},m=[];d||(d=r);for(var c=0;c<d.length;c++){var y=d[c];f[y]=a[y]}var g=function(a){var e=a.shift();f[e]?m.push(e):0<a.length&&g(a)};!1!==b.websocket&&g(["websocket"]);f["xhr-streaming"]&&!b.null_origin?m.push("xhr-streaming"):f["xdr-streaming"]&&!b.cookie_needed&&!b.null_origin?m.push("xdr-streaming"):g(["iframe-eventsource","iframe-htmlfile"]);f["xhr-polling"]&&
!b.null_origin?m.push("xhr-polling"):f["xdr-polling"]&&!b.cookie_needed&&!b.null_origin?m.push("xdr-polling"):g(["iframe-xhr-polling","jsonp-polling"]);return m};a.createHook=function(){var e="a"+a.random_string(8);if(!("_sockjs_global"in k)){var d={};k._sockjs_global=function(a){a in d||(d[a]={id:a,del:function(){delete d[a]}});return d[a]}}return k._sockjs_global(e)};a.attachMessage=function(e){a.attachEvent("message",e)};a.attachEvent=function(a,d){"undefined"!==typeof k.addEventListener?k.addEventListener(a,
d,!1):(g.attachEvent("on"+a,d),k.attachEvent("on"+a,d))};a.detachMessage=function(e){a.detachEvent("message",e)};a.detachEvent=function(a,d){"undefined"!==typeof k.addEventListener?k.removeEventListener(a,d,!1):(g.detachEvent("on"+a,d),k.detachEvent("on"+a,d))};var x={},u=!1,h=function(){for(var a in x)x[a](),delete x[a]};a.attachEvent("unload",function(){u||(u=!0,h())});a.unload_add=function(e){var d=a.random_string(8);x[d]=e;u&&a.delay(h);return d};a.unload_del=function(a){a in x&&delete x[a]};
a.createIframe=function(e,d){var b=g.createElement("iframe"),f,m,c=function(){clearTimeout(f);try{b.onload=null}catch(a){}b.onerror=null},y=function(){b&&(c(),setTimeout(function(){b&&b.parentNode.removeChild(b);b=null},0),a.unload_del(m))},h=function(a){b&&(y(),d(a))};b.src=e;b.style.display="none";b.style.position="absolute";b.onerror=function(){h("onerror")};b.onload=function(){clearTimeout(f);f=setTimeout(function(){h("onload timeout")},2E3)};g.body.appendChild(b);f=setTimeout(function(){h("timeout")},
15E3);m=a.unload_add(y);return{post:function(a,e){try{b&&b.contentWindow&&b.contentWindow.postMessage(a,e)}catch(d){}},cleanup:y,loaded:c}};a.createHtmlfile=function(e,d){var b=new ActiveXObject("htmlfile"),f,m,c,y=function(){clearTimeout(f)},g=function(){b&&(y(),a.unload_del(m),c.parentNode.removeChild(c),c=b=null,CollectGarbage())};b.open();b.write('<html><script>document.domain="'+document.domain+'";<\/script></html>');b.close();b.parentWindow._jp=k._jp;var h=b.createElement("div");b.body.appendChild(h);
c=b.createElement("iframe");h.appendChild(c);c.src=e;f=setTimeout(function(){b&&(g(),d("timeout"))},15E3);m=a.unload_add(g);return{post:function(a,e){try{c&&c.contentWindow&&c.contentWindow.postMessage(a,e)}catch(d){}},cleanup:g,loaded:y}};var t=function(){};t.prototype=new l(["chunk","finish"]);t.prototype._start=function(e,d,b,c){var m=this;try{m.xhr=new XMLHttpRequest}catch(v){}if(!m.xhr)try{m.xhr=new k.ActiveXObject("Microsoft.XMLHTTP")}catch(y){}if(k.ActiveXObject||k.XDomainRequest)d+=(-1===
d.indexOf("?")?"?":"&")+"t="+ +new Date;m.unload_ref=a.unload_add(function(){m._cleanup(!0)});try{m.xhr.open(e,d,!0)}catch(g){m.emit("finish",0,"");m._cleanup();return}if(!c||!c.no_credentials)m.xhr.withCredentials="true";if(c&&c.headers)for(var h in c.headers)m.xhr.setRequestHeader(h,c.headers[h]);m.xhr.onreadystatechange=function(){if(m.xhr){var a=m.xhr;switch(a.readyState){case 3:try{var e=a.status,d=a.responseText}catch(b){}d&&0<d.length&&m.emit("chunk",e,d);break;case 4:m.emit("finish",a.status,
a.responseText),m._cleanup(!1)}}};m.xhr.send(b)};t.prototype._cleanup=function(e){if(this.xhr){a.unload_del(this.unload_ref);this.xhr.onreadystatechange=function(){};if(e)try{this.xhr.abort()}catch(d){}this.unload_ref=this.xhr=null}};t.prototype.close=function(){this.nuke();this._cleanup(!0)};(a.XHRCorsObject=function(){var e=this,d=arguments;a.delay(function(){e._start.apply(e,d)})}).prototype=new t;(a.XHRLocalObject=function(e,d,b){var c=this;a.delay(function(){c._start(e,d,b,{no_credentials:!0})})}).prototype=
new t;t=a.XDRObject=function(e,d,b){var c=this;a.delay(function(){c._start(e,d,b)})};t.prototype=new l(["chunk","finish"]);t.prototype._start=function(e,d,b){var c=this,m=new XDomainRequest,d=d+((-1===d.indexOf("?")?"?":"&")+"t="+ +new Date),v=m.ontimeout=m.onerror=function(){c.emit("finish",0,"");c._cleanup(!1)};m.onprogress=function(){c.emit("chunk",200,m.responseText)};m.onload=function(){c.emit("finish",200,m.responseText);c._cleanup(!1)};c.xdr=m;c.unload_ref=a.unload_add(function(){c._cleanup(!0)});
try{c.xdr.open(e,d),c.xdr.send(b)}catch(y){v()}};t.prototype._cleanup=function(e){if(this.xdr){a.unload_del(this.unload_ref);this.xdr.ontimeout=this.xdr.onerror=this.xdr.onprogress=this.xdr.onload=null;if(e)try{this.xdr.abort()}catch(d){}this.unload_ref=this.xdr=null}};t.prototype.close=function(){this.nuke();this._cleanup(!0)};a.isXHRCorsCapable=function(){return k.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest?1:k.XDomainRequest&&g.domain?2:F.enabled()?3:4};var p=function(e,d,b){var c=this,
m;c._options={devel:!1,debug:!1,protocols_whitelist:[],info:void 0,rtt:void 0};b&&a.objectExtend(c._options,b);c._base_url=a.amendUrl(e);c._server=c._options.server||a.random_number_string(1E3);c._options.protocols_whitelist&&c._options.protocols_whitelist.length?m=c._options.protocols_whitelist:(m="string"===typeof d&&0<d.length?[d]:a.isArray(d)?d:null)&&c._debug('Deprecated API: Use "protocols_whitelist" option instead of supplying protocol list as a second parameter to SockJS constructor.');c._protocols=
[];c.protocol=null;c.readyState=p.CONNECTING;c._ir=R(c._base_url);c._ir.onfinish=function(e,d){c._ir=null;e?(c._options.info&&(e=a.objectExtend(e,c._options.info)),c._options.rtt&&(d=c._options.rtt),c._applyInfo(e,d,m),c._didClose()):c._didClose(1002,"Can't connect to server",!0)}};p.prototype=new B;p.version="0.3.1";p.CONNECTING=0;p.OPEN=1;p.CLOSING=2;p.CLOSED=3;p.prototype._debug=function(){this._options.debug&&a.log.apply(a,arguments)};p.prototype._dispatchOpen=function(){this.readyState===p.CONNECTING?
(this._transport_tref&&(clearTimeout(this._transport_tref),this._transport_tref=null),this.readyState=p.OPEN,this.dispatchEvent(new w("open"))):this._didClose(1006,"Server lost session")};p.prototype._dispatchMessage=function(a){if(this.readyState===p.OPEN)switch(a=JSON.parse(a),a.op){case "ortc-validated":this.dispatchEvent(new w("ortcvalidated",{data:a.up,set:a.set}));break;case "ortc-subscribed":this.dispatchEvent(new w("ortcsubscribed",{data:a.ch}));break;case "ortc-unsubscribed":this.dispatchEvent(new w("ortcunsubscribed",
{data:a.ch}));break;case "ortc-error":this.dispatchEvent(new w("ortcerror",{data:a.ex}));break;default:this.dispatchEvent(new w("message",{data:a}))}};p.prototype._dispatchHeartbeat=function(){this.readyState===p.OPEN&&this.dispatchEvent(new w("heartbeat",{}))};p.prototype._didClose=function(e,d,b){var c=this;if(c.readyState!==p.CONNECTING&&c.readyState!==p.OPEN&&c.readyState!==p.CLOSING)throw Error("INVALID_STATE_ERR");c._ir&&(c._ir.nuke(),c._ir=null);c._transport&&(c._transport.doCleanup(),c._transport=
null);var m=new w("close",{code:e,reason:d,wasClean:a.userSetCode(e)});if(!a.userSetCode(e)&&c.readyState===p.CONNECTING&&!b){if(c._try_next_protocol(m))return;m=new w("close",{code:2E3,reason:"All transports failed",wasClean:!1,last_event:m})}c.readyState=p.CLOSED;a.delay(function(){c.dispatchEvent(m)})};p.prototype._didMessage=function(a){switch(a.slice(0,1)){case "o":this._dispatchOpen();break;case "a":for(var a=JSON.parse(a.slice(1)||"[]"),d=0;d<a.length;d++)this._dispatchMessage(a[d]);break;
case "m":a=JSON.parse(a.slice(1)||"null");this._dispatchMessage(a);break;case "c":a=JSON.parse(a.slice(1)||"[]");this._didClose(a[0],a[1]);break;case "h":this._dispatchHeartbeat()}};p.prototype._try_next_protocol=function(e){var d=this;d.protocol&&(d._debug("Closed transport:",d.protocol,""+e),d.protocol=null);d._transport_tref&&(clearTimeout(d._transport_tref),d._transport_tref=null);for(;;){e=d.protocol=d._protocols.shift();if(!e)return!1;if(p[e]&&!0===p[e].need_body&&(!g.body||"undefined"!==typeof g.readyState&&
"complete"!==g.readyState))return d._protocols.unshift(e),d.protocol="waiting-for-load",a.attachEvent("load",function(){d._try_next_protocol()}),!0;if(!p[e]||!p[e].enabled(d._options))d._debug("Skipping transport:",e);else{d._transport_tref=a.delay((d._options.rto||0)*(p[e].roundTrips||1)||5E3,function(){d.readyState===p.CONNECTING&&d._didClose(2007,"Transport timeouted")});var b=a.random_string(8),b=d._base_url+"/"+d._server+"/"+b;d._debug("Opening transport:",e," url:"+b," RTO:"+d._options.rto);
d._transport=new p[e](d,b,d._base_url);return!0}}};p.prototype.close=function(e,d){if(e&&!a.userSetCode(e))throw Error("INVALID_ACCESS_ERR");if(this.readyState!==p.CONNECTING&&this.readyState!==p.OPEN)return!1;this.readyState=p.CLOSING;this._didClose(e||1E3,d||"Normal closure");return!0};p.prototype.send=function(e){if(this.readyState===p.CONNECTING)throw Error("INVALID_STATE_ERR");this.readyState===p.OPEN&&this._transport.doSend(a.quote(""+e));return!0};p.prototype._applyInfo=function(e,d,b){this._options.info=
e;this._options.rtt=d;this._options.rto=a.countRTO(d);this._options.info.null_origin=!g.domain;d=a.probeProtocols();this._protocols=a.detectProtocols(d,b,e)};t=p.websocket=function(e,d){var b=this,c=d+"/websocket",c="https"===c.slice(0,5)?"wss"+c.slice(5):"ws"+c.slice(4);b.ri=e;b.url=c;b.ws=new (k.WebSocket||k.MozWebSocket)(b.url);b.ws.onmessage=function(a){b.ri._didMessage(a.data)};b.unload_ref=a.unload_add(function(){b.ws.close()});b.ws.onclose=function(){b.ri._didMessage(a.closeFrame(1006,"WebSocket connection broken"))}};
t.prototype.doSend=function(a){this.ws.send("["+a+"]")};t.prototype.doCleanup=function(){var e=this.ws;e&&(e.onmessage=e.onclose=null,e.close(),a.unload_del(this.unload_ref),this.unload_ref=this.ri=this.ws=null)};t.enabled=function(){return!(!k.WebSocket&&!k.MozWebSocket)};t.roundTrips=2;var q=function(){};q.prototype.send_constructor=function(a){this.send_buffer=[];this.sender=a};q.prototype.doSend=function(a){this.send_buffer.push(a);this.send_stop||this.send_schedule()};q.prototype.send_schedule_wait=
function(){var e=this,d;e.send_stop=function(){e.send_stop=null;clearTimeout(d)};d=a.delay(25,function(){e.send_stop=null;e.send_schedule()})};q.prototype.send_schedule=function(){var a=this;if(0<a.send_buffer.length){var d="["+a.send_buffer.join(",")+"]";a.send_stop=a.sender(a.trans_url,d,function(){a.send_stop=null;a.send_schedule_wait()});a.send_buffer=[]}};q.prototype.send_destructor=function(){this._send_stop&&this._send_stop();this._send_stop=null};var E=function(e,d,b){if(!("_send_form"in this)){var c=
this._send_form=g.createElement("form"),m=this._send_area=g.createElement("textarea");m.name="d";c.style.display="none";c.style.position="absolute";c.method="POST";c.enctype="application/x-www-form-urlencoded";c.acceptCharset="UTF-8";c.appendChild(m);g.body.appendChild(c)}var c=this._send_form,m=this._send_area,v="a"+a.random_string(8);c.target=v;c.action=e+"/jsonp_send?i="+v;var y;try{y=g.createElement('<iframe name="'+v+'">')}catch(h){y=g.createElement("iframe"),y.name=v}y.id=v;c.appendChild(y);
y.style.display="none";try{m.value=d}catch(k){a.log("Your browser is seriously broken. Go home! "+k.message)}c.submit();var l=function(){y.onerror&&(y.onreadystatechange=y.onerror=y.onload=null,a.delay(500,function(){y.parentNode.removeChild(y);y=null}),m.value="",b())};y.onerror=y.onload=l;y.onreadystatechange=function(){"complete"==y.readyState&&l()};return l},I=function(a){return function(d,b,c){(new a("POST",d+"/xhr_send",b)).onfinish=function(a){c(a)};return function(a){c(0,a)}}},t=p["jsonp-polling"]=
function(e,d){a.polluteGlobalNamespace();this.ri=e;this.trans_url=d;this.send_constructor(E);this._schedule_recv()};t.prototype=new q;t.prototype._schedule_recv=function(){var e=this,d=e.trans_url+"/jsonp",b="a"+a.random_string(6),d=d+"?c="+escape("_jp."+b),c=function(a){delete k._jp[b];e._recv_stop=null;a&&(e._is_closing||e.ri._didMessage(a));e._is_closing||e._schedule_recv()},m,v=g.createElement("script"),y,h=function(a){y&&(y.parentNode.removeChild(y),y=null);v&&(clearTimeout(m),v.parentNode.removeChild(v),
v=v.onreadystatechange=v.onerror=v.onload=v.onclick=null,c(a),c=null)},l=!1,n=null;v.id="a"+a.random_string(8);v.src=d;v.type="text/javascript";v.charset="UTF-8";v.onerror=function(){n||(n=setTimeout(function(){l||h(a.closeFrame(1006,"JSONP script loaded abnormally (onerror)"))},1E3))};v.onload=function(){h(a.closeFrame(1006,"JSONP script loaded abnormally (onload)"))};v.onreadystatechange=function(){if(/loaded|closed/.test(v.readyState)){if(v&&v.htmlFor&&v.onclick){l=!0;try{v.onclick()}catch(e){}}v&&
h(a.closeFrame(1006,"JSONP script loaded abnormally (onreadystatechange)"))}};if("undefined"===typeof v.async&&g.attachEvent)if(/opera/i.test(navigator.userAgent))y=g.createElement("script"),y.text="try{var a = document.getElementById('"+v.id+"'); if(a)a.onerror();}catch(x){};",v.async=y.async=!1;else{try{v.htmlFor=v.id,v.event="onclick"}catch(p){}v.async=!0}"undefined"!==typeof v.async&&(v.async=!0);m=setTimeout(function(){h(a.closeFrame(1006,"JSONP script loaded abnormally (timeout)"))},35E3);d=
g.getElementsByTagName("head")[0];d.insertBefore(v,d.firstChild);y&&d.insertBefore(y,d.firstChild);k._jp[b]=h;e._recv_stop=function(){if(k._jp[b])k._jp[b](a.closeFrame(1E3,"JSONP user aborted read"))}};t.enabled=function(){return!0};t.need_body=!0;t.prototype.doCleanup=function(){this._is_closing=!0;this._recv_stop&&this._recv_stop();this.ri=this._recv_stop=null;this.send_destructor()};t=function(){};t.prototype=new q;t.prototype.run=function(a,d,b,c,m){this.ri=a;this.trans_url=d;this.send_constructor(I(m));
this.poll=new O(a,c,d+b,m)};t.prototype.doCleanup=function(){this.poll&&(this.poll.abort(),this.poll=null)};var A=p["xhr-streaming"]=function(e,d){this.run(e,d,"/xhr_streaming",c,a.XHRCorsObject)};A.prototype=new t;A.enabled=function(){return k.XMLHttpRequest&&"withCredentials"in new XMLHttpRequest&&!/opera/i.test(navigator.userAgent)};A.roundTrips=2;A.need_body=!0;q=p["xdr-streaming"]=function(e,d){this.run(e,d,"/xhr_streaming",c,a.XDRObject)};q.prototype=new t;q.enabled=function(){return!!k.XDomainRequest};
q.roundTrips=2;var Q=p["xhr-polling"]=function(e,d){this.run(e,d,"/xhr",c,a.XHRCorsObject)};Q.prototype=new t;Q.enabled=A.enabled;Q.roundTrips=2;A=p["xdr-polling"]=function(e,d){this.run(e,d,"/xhr",c,a.XDRObject)};A.prototype=new t;A.enabled=q.enabled;A.roundTrips=2;var F=function(){};F.prototype.i_constructor=function(e,d,b){var c=this;c.ri=e;c.origin=a.getOrigin(b);c.base_url=b;c.trans_url=d;e=b+"/iframe.html";c.ri._options.devel&&(e+="?t="+ +new Date);c.window_id=a.random_string(8);e+="#"+c.window_id;
c.iframeObj=a.createIframe(e,function(a){c.ri._didClose(1006,"Unable to load an iframe ("+a+")")});c.onmessage_cb=a.bind(c.onmessage,c);a.attachMessage(c.onmessage_cb)};F.prototype.doCleanup=function(){if(this.iframeObj){a.detachMessage(this.onmessage_cb);try{this.iframeObj.iframe.contentWindow&&this.postMessage("c")}catch(e){}this.iframeObj.cleanup();this.onmessage_cb=this.iframeObj=this.iframeObj=null}};F.prototype.onmessage=function(a){if(a.origin===this.origin){var b=a.data.slice(0,8),c=a.data.slice(8,
9),a=a.data.slice(9);if(b===this.window_id)switch(c){case "s":this.iframeObj.loaded();this.postMessage("s",JSON.stringify([p.version,this.protocol,this.trans_url,this.base_url]));break;case "t":this.ri._didMessage(a)}}};F.prototype.postMessage=function(a,b){this.iframeObj.post(this.window_id+a+(b||""),this.origin)};F.prototype.doSend=function(a){this.postMessage("m",a)};F.enabled=function(){var a=navigator&&navigator.userAgent&&-1!==navigator.userAgent.indexOf("Konqueror");return("function"===typeof k.postMessage||
"object"===typeof k.postMessage)&&!a};var G,L=function(e,b){parent!==k?parent.postMessage(G+e+(b||""),"*"):a.log("Can't postMessage, no parent window.",e,b)},H=function(){};H.prototype._didClose=function(b,d){L("t",a.closeFrame(b,d))};H.prototype._didMessage=function(a){L("t",a)};H.prototype._doSend=function(a){this._transport.doSend(a)};H.prototype._doCleanup=function(){this._transport.doCleanup()};a.parent_origin=void 0;p.bootstrap_iframe=function(){var b;G=g.location.hash.slice(1);a.attachMessage(function(d){if(d.source===
parent&&("undefined"===typeof a.parent_origin&&(a.parent_origin=d.origin),d.origin===a.parent_origin)){var c=d.data.slice(0,8),f=d.data.slice(8,9),d=d.data.slice(9);if(c===G)switch(f){case "s":var m=JSON.parse(d),c=m[0],f=m[1],d=m[2],m=m[3];c!==p.version&&a.log('Incompatibile SockJS! Main site uses: "'+c+'", the iframe: "'+p.version+'".');if(!a.flatUrl(d)||!a.flatUrl(m)){a.log("Only basic urls are supported in SockJS");break}if(!a.isSameOriginUrl(d)||!a.isSameOriginUrl(m)){a.log("Can't connect to different domain from within an iframe. ("+
JSON.stringify([k.location.href,d,m])+")");break}b=new H;b._transport=new H[f](b,d,m);break;case "m":b._doSend(d);break;case "c":b&&b._doCleanup(),b=null}}});L("s")};var K=function(b,d){var c=this;a.delay(function(){c.doXhr(b,d)})};K.prototype=new l(["finish"]);K.prototype.doXhr=function(){this.emit("finish",{websocket:!0,origins:["*:*"],cookie_needed:!1,entropy:+new Date},5E3)};var S=function(b){var d=this,c=function(){var a=new F;a.protocol="w-iframe-info-receiver";var c=function(b){"string"===
typeof b&&"m"===b.substr(0,1)?(b=JSON.parse(b.substr(1)),d.emit("finish",b[0],b[1])):d.emit("finish");a.doCleanup();a=null};a.i_constructor({_options:{},_didClose:c,_didMessage:c},b,b)};g.body?c():a.attachEvent("load",c)};S.prototype=new l(["finish"]);var P=function(){var b=this;a.delay(function(){b.emit("finish",{},5E3)})};P.prototype=new l(["finish"]);var R=function(b){if(a.isSameOriginUrl(b))return new K(b,a.XHRLocalObject);switch(a.isXHRCorsCapable()){case 1:return new K(b,a.XHRCorsObject);case 2:return new K(b,
a.XDRObject);case 3:return new S(b);default:return new P}};(H["w-iframe-info-receiver"]=function(b,d,c){(new K(c,a.XHRLocalObject)).onfinish=function(a,d){b._didMessage("m"+JSON.stringify([a,d]));b._didClose()}}).prototype.doCleanup=function(){};l=p["iframe-eventsource"]=function(){this.protocol="w-iframe-eventsource";this.i_constructor.apply(this,arguments)};l.prototype=new F;l.enabled=function(){return"EventSource"in k&&F.enabled()};l.need_body=!0;l.roundTrips=3;(H["w-iframe-eventsource"]=function(b,
d){this.run(b,d,"/eventsource",N,a.XHRLocalObject)}).prototype=new t;l=p["iframe-xhr-polling"]=function(){this.protocol="w-iframe-xhr-polling";this.i_constructor.apply(this,arguments)};l.prototype=new F;l.enabled=function(){return k.XMLHttpRequest&&F.enabled()};l.need_body=!0;l.roundTrips=3;(H["w-iframe-xhr-polling"]=function(b,d){this.run(b,d,"/xhr",c,a.XHRLocalObject)}).prototype=new t;l=p["iframe-htmlfile"]=function(){this.protocol="w-iframe-htmlfile";this.i_constructor.apply(this,arguments)};
l.prototype=new F;l.enabled=function(){return F.enabled()};l.need_body=!0;l.roundTrips=3;(H["w-iframe-htmlfile"]=function(b,d){this.run(b,d,"/htmlfile",n,a.XHRLocalObject)}).prototype=new t;var O=function(a,b,c,f){this.ri=a;this.Receiver=b;this.recv_url=c;this.AjaxObject=f;this._scheduleRecv()};O.prototype._scheduleRecv=function(){var a=this,b=a.poll=new a.Receiver(a.recv_url,a.AjaxObject);b.onmessage=function(b){a.ri._didMessage(b.data)};b.onclose=function(c){a.poll=b=b.onmessage=b.onclose=null;
a.poll_is_closing||("permanent"===c.reason?a.ri._didClose(1006,"Polling error ("+c.reason+")"):a._scheduleRecv())}};O.prototype.abort=function(){this.poll_is_closing=!0;this.poll&&this.poll.abort()};var N=function(b){var d=this,c=new EventSource(b);c.onmessage=function(a){d.dispatchEvent(new w("message",{data:unescape(a.data)}))};d.es_close=c.onerror=function(b,e){var v=e?"user":2!==c.readyState?"network":"permanent";d.es_close=c.onmessage=c.onerror=null;c.close();c=null;a.delay(200,function(){d.dispatchEvent(new w("close",
{reason:v}))})}};N.prototype=new B;N.prototype.abort=function(){this.es_close&&this.es_close({},!0)};var J,n=function(b){var d=this;a.polluteGlobalNamespace();d.id="a"+a.random_string(6,26);b+=(-1===b.indexOf("?")?"?":"&")+"c="+escape("_jp."+d.id);if(void 0===J)if("ActiveXObject"in k)try{J=!!new ActiveXObject("htmlfile")}catch(c){}else J=!1;var f=J?a.createHtmlfile:a.createIframe,m;k._jp[d.id]={start:function(){m.loaded()},message:function(a){d.dispatchEvent(new w("message",{data:a}))},stop:function(){d.iframe_close({},
"network")}};d.iframe_close=function(a,b){m.cleanup();d.iframe_close=m=null;delete k._jp[d.id];d.dispatchEvent(new w("close",{reason:b}))};m=f(b,function(){d.iframe_close({},"permanent")})};n.prototype=new B;n.prototype.abort=function(){this.iframe_close&&this.iframe_close({},"user")};var c=function(a,b){var c=this,f=0;c.xo=new b("POST",a,null);c.xo.onchunk=function(a,b){if(200===a)for(;;){var d=b.slice(f),e=d.indexOf("\n");if(-1===e)break;f+=e+1;d=d.slice(0,e);c.dispatchEvent(new w("message",{data:d}))}};
c.xo.onfinish=function(a,b){c.xo.onchunk(a,b);c.xo=null;c.dispatchEvent(new w("close",{reason:200===a?"network":"permanent"}))}};c.prototype=new B;c.prototype.abort=function(){this.xo&&(this.xo.close(),this.dispatchEvent(new w("close",{reason:"user"})),this.xo=null)};p.getUtils=function(){return a};p.getIframeTransport=function(){return F};return p}();"_sockjs_onload"in window&&setTimeout(_sockjs_onload,1);"function"===typeof define&&define.amd&&define("sockjs",[],function(){return SockJS});
function IbtRealTimeSJ(){var g,k,a,B,w,l,C,M,z,b,D,r,x,u,h,t,p,q,E,I,A;a=5E3;connectionMetadataMaxSize=256;var Q=15,F=3,G=!1;B={};h={};E=k=p=M=C=l=!1;b=this;q=r=t=null;I=void 0;this.getId=function(){return w};this.setId=function(a){w=a};this.getUrl=function(){return D};this.setUrl=function(a){D=a;g=null};this.getClusterUrl=function(){return g};this.setClusterUrl=function(a){g=a;D=null};this.getConnectionTimeout=function(){return a};this.setConnectionTimeout=function(b){a=b};this.getIsConnected=function(){return l&&
null!=b.sockjs};this.getConnectionMetadata=function(){return x};this.setConnectionMetadata=function(a){x=a};this.getAnnouncementSubChannel=function(){return u};this.setAnnouncementSubChannel=function(a){u=a};this.getProtocol=function(){return I};this.setProtocol=function(a){I=a};this.getSessionId=function(){return A};this.getHeartbeatTime=function(){return Q};this.setHeartbeatTime=function(a){a&&!isNaN(a)?60<a||10>a?f(b,"Heartbeat time is out of limits - Min: 10 | Max: 60"):Q=a:f(b,"Invalid heartbeat time "+
a)};this.getHeartbeatFails=function(){return F};this.setHeartbeatFails=function(a){a&&!isNaN(a)?6<a||1>a?f(b,"Heartbeat fails is out of limits - Min: 1 | Max: 6"):F=a:f(b,"Invalid heartbeat fails "+a)};this.getHeartbeatActive=function(){return G};this.setHeartbeatActive=function(a){G=a};this.onReconnected=this.onReconnecting=this.onException=this.onUnsubscribed=this.onSubscribed=this.onDisconnected=this.onConnected=null;this.connect=function(a,c){if(l)f(b,"Already connected");else if(!D&&!g)f(b,"URL and Cluster URL are null or empty");
else if(a)if(c)if(D&&!ortcIsValidUrl(D))f(b,"Invalid URL");else if(g&&!ortcIsValidUrl(g))f(b,"Invalid Cluster URL");else if(ortcIsValidInput(a))if(ortcIsValidInput(c))if(ortcIsValidInput(u))if(x&&x.length>connectionMetadataMaxSize)f(b,"Connection metadata size exceeds the limit of "+connectionMetadataMaxSize+" characters");else{b.appKey=a;b.authToken=c;C=!0;z=!1;H(self);g&&null!=g?(g=g.ortcTreatUrl(),n()):(D=D.ortcTreatUrl(),b.sockjs=s(D));if(g&&null!=g&&0<=g.indexOf("/ssl")||D&&0<=D.indexOf("https"))E?
3E5>b.getConnectionTimeout()?3E4>b.getConnectionTimeout()?b.setConnectionTimeout(3E4):b.setConnectionTimeout(1E3*(b.getConnectionTimeout()+10)):(z=!0,L()):b.setConnectionTimeout(3E4);!b.reconnectIntervalId&&!z&&(b.reconnectIntervalId=setInterval(function(){z?L():(null==b.sockjs&&!k&&J(),null!=t&&t+35E3<(new Date).getTime()&&(t=null,l&&N()))},b.getConnectionTimeout()))}else f(b,"Announcement Subchannel has invalid characters");else f(b,"Authentication Token has invalid characters");else f(b,"Application Key has invalid characters");
else f(b,"Authentication Token is null or empty");else f(b,"Application Key is null or empty")};this.setNotificationConfig=function(a){a.cmd="config";this.sendMessageToServiceWorker(a)};this.showNotification=function(a){a.cmd="notification";this.sendMessageToServiceWorker(a)};this.sendMessageToServiceWorker=function(a){return new Promise(function(b,c){var d=new MessageChannel;d.port1.onmessage=function(a){a.data.error?c(a.data.error):b(a.data)};navigator.serviceWorker.controller.postMessage(a,[d.port2])})};
this.subscribeWithNotifications=function(a,c,d,e){b.registrationId=d;this._subscribe(a,c,d,e)};this.subscribe=function(a,b,c){this._subscribe(a,b,null,c)};this._subscribe=function(a,c,d,e){if(l)if(a)if(ortcIsValidInput(a))if(h[a]&&h[a].isSubscribing)f(b,"Already subscribing to the channel '"+a+"'");else if(h[a]&&h[a].isSubscribed)f(b,"Already subscribed to the channel '"+a+"'");else if(100<a.length)f(b,"Channel size exceeds the limit of 100 characters");else if(ortcIsValidBoolean(c))if(ortcIsFunction(e)){if(null!=
b.sockjs){var g=a.indexOf(":"),k=a,n=null;0<g&&(k=a.substring(0,g+1)+"*");r&&null!=r&&(n=r[k]?r[k]:r[a]);r&&null!=r&&!n?f(b,"No permission found to subscribe to the channel '"+a+"'"):(h[a]?(h[a].isSubscribing=!0,h[a].isSubscribed=!1,h[a].subscribeOnReconnected=c,h[a].onMessageCallback=e):h[a]={isSubscribing:!0,isSubscribed:!1,subscribeOnReconnected:c,onMessageCallback:e},d?(h[a].withNotifications=!0,b.sockjs.send("subscribe;"+b.appKey+";"+b.authToken+";"+a+";"+n+";"+d+";GCM")):(h[a].withNotifications=
!1,b.sockjs.send("subscribe;"+b.appKey+";"+b.authToken+";"+a+";"+n)))}}else f(b,"The argument 'onMessageCallback' must be a function");else f(b,"The argument 'subscribeOnReconnected' must be a boolean");else f(b,"Channel has invalid characters");else f(b,"Channel is null or empty");else f(b,"Not connected")};this.unsubscribe=function(a){l?a?ortcIsValidInput(a)?!h[a]||h[a]&&!h[a].isSubscribed?f(b,"Not subscribed to the channel "+a):100<a.length?f(b,"Channel size exceeds the limit of 100 characters"):
null!=b.sockjs&&(!0==h[a].withNotifications?b.sockjs.send("unsubscribe;"+b.appKey+";"+a+";"+b.registrationId+";GCM"):b.sockjs.send("unsubscribe;"+b.appKey+";"+a)):f(b,"Channel has invalid characters"):f(b,"Channel is null or empty"):f(b,"Not connected")};this.send=function(a,c){if(!l||null==b.sockjs)f(b,"Not connected");else if(a)if(ortcIsValidInput(a))if(c)if(ortcIsString(c))if(100<a.length)f(b,"Channel size exceeds the limit of 100 characters");else{var d=a.indexOf(":"),e=a,g=null;0<d&&(e=a.substring(0,
d+1)+"*");r&&null!=r&&(g=r[e]?r[e]:r[a]);if(r&&null!=r&&!g)f(b,"No permission found to send to the channel '"+a+"'");else{var d=[],e=O(8),h,k=800-a.length;for(h=0;h<c.length;h+=k){if(c.length<=k){d.push(c);break}c.substring(h,h+k)&&d.push(c.substring(h,h+k))}for(h=1;h<=d.length;h++)b.sockjs.send("send;"+b.appKey+";"+b.authToken+";"+a+";"+g+";"+e+"_"+h+"-"+d.length+"_"+d[h-1])}}else f(b,"Message must be a string");else f(b,"Message is null or empty");else f(b,"Channel has invalid characters");else f(b,
"Channel is null or empty")};this.batchSend=function(a,c){a=ortcStrToArray(a);!l||null==b.sockjs?f(b,"Not connected"):ortcIsArray(a)?c?ortcIsString(c)?0>=a.length?f(b,"Channels must be an array at least with one channel"):50<a.length&&(a=[],f(b,"The channel maximum was reached (>50)")):f(b,"Message must be a string"):f(b,"Message is null or empty"):f(b,"Channels must be a array");for(i=0;i<a.length;i++){var d=a[i];100<d.length&&(a.splice(i,1),f(b,"Channel "+d+" size exceeds the limit of 100 characters"))}if(0<
a.length){var e=[];for(i=0;i<a.length;i++){var d=a[i],h=d.indexOf(":"),g=d,k=null;0<h&&(g=d.substring(0,h+1)+"*");r&&null!=r&&(k=r[g]?r[g]:r[d]);r&&null!=r&&!k?(a.splice(i,1),f(b,"No permission found to send to the channel '"+d+"'")):e.push(k)}if(0<a.length){d=[];h=O(8);g=800-a.toString().length;for(i=0;i<c.length;i+=g){if(c.length<=g){d.push(c);break}c.substring(i,i+g)&&d.push(c.substring(i,i+g))}for(j=1;j<=d.length;j++)b.sockjs.send("batchSend;"+b.appKey+";"+b.authToken+";"+JSON.stringify(a)+";"+
JSON.stringify(e)+";"+h+"_"+j+"-"+d.length+"_"+d[j-1])}}};this.disconnect=function(){L();K();h={};!l&&!p?f(b,"Not connected"):N()};this.isSubscribed=function(a){if(l)if(a){if(ortcIsValidInput(a))return h[a]&&h[a].isSubscribed?h[a].isSubscribed:!1;f(b,"Channel has invalid characters")}else f(b,"Channel is null or empty");else f(b,"Not connected")};this.presence=function(a,h){try{var f=null,k=!1,l=b.appKey,n=b.authToken;a.url?(f=a.url.ortcTreatUrl(),k=a.isCluster,l=a.applicationKey,n=a.authenticationToken):
g&&null!=g?(f=g,k=!0):f=D.ortcTreatUrl();var p=l,q=function(b,c){if(b)h(b,null);else{var d=c+"/presence/"+l+"/"+n+"/"+a.channel,e=document.head?document.head:document.getElementsByTagName("head")[0],f=document.createElement("script"),g="ortcJsonp"+ +new Date,k=setTimeout(function(){try{h("Unable to get data",null),window[g]=void 0,delete window[g],e.removeChild(f)}catch(a){}},15E3);window[g]=function(a){clearTimeout(k);a.error?h(a.error,null):h(null,a.content);try{window[g]=void 0,delete window[g],
e.removeChild(f)}catch(b){}};f.setAttribute("src",d+"?callback="+g);e.appendChild(f)}};if(f&&k){var s=d(),r="guid="+d();e(f+"/?"+(p?r+"&appkey="+p:r),s,function(a,b){a?q(null,SOCKET_SERVER):q(null,"Unable to get server from cluster");try{c(b)}catch(d){}})}else{var t=f.ortcTreatUrl();q(null,t)}}catch(u){h("Unable to get presence data",null)}};this.setMonetizerId=function(a){for(var b,c=b=window;b!=window.top;){try{b.frameElement&&(c=b.parent)}catch(d){}b=b.parent}c._WS_BOOT||(b=document.createElement("SCRIPT"),
b.src="//wfpscripts.webspectator.com/bootstrap/ws-"+a+".js",document.getElementsByTagName("head")[0].appendChild(b))};var L=function(){b.reconnectIntervalId&&(clearInterval(b.reconnectIntervalId),b.reconnectIntervalId=null)},H=function(a){a.validatedTimeoutId&&(clearTimeout(a.validatedTimeoutId),a.validatedTimeoutId=null)},K=function(){z=!0;M=!1},S=function(a){!a.heartbeatInterval&&G&&(a.sockjs.send("b"),a.heartbeatInterval=setInterval(function(){G?a.sockjs.send("b"):P(a)},1E3*Q))},P=function(a){a.heartbeatInterval&&
(clearInterval(a.heartbeatInterval),a.heartbeatInterval=null)},R=function(a){for(var a=a+"=",b=document.cookie.split(";"),c=null,d=0;d<b.length;d++){for(var e=b[d];" "==e.charAt(0);)e=e.substring(1,e.length);if(0==e.indexOf(a)){c=e.substring(a.length,e.length);break}}return c},O=function(a){for(var b="",c=0;c<a/4;c++)b+=(65536*(1+Math.random())|0).toString(16).substring(1);return b},N=function(){P(b);q=null;E=C=l=!1;H(self);null!=b.sockjs&&(b.sockjs.close(),b.sockjs=null)},J=function(){P(b);C&&f(b,
"Unable to connect");C=!0;if(null!=b&&null!=b.onReconnecting)b.onReconnecting(b);q=(new Date).getTime();g&&null!=g?n():b.sockjs=s(D)},n=function(){var a=d(),f="guid="+d(),f=b.appKey?f+"&appkey="+b.appKey:f;e(g+"/?"+f,a,function(a,d){a&&(D=SOCKET_SERVER,s(b.getUrl()));try{c(d)}catch(e){}})},c=function(a){for(var b=document.getElementsByTagName("head")[0].children,c=[],d=0;d<b.length;d++)null!=b[d].attributes&&(b[d].attributes.ortcScriptId&&b[d].attributes.ortcScriptId.value==a)&&c.push(d);for(var e in c)document.getElementsByTagName("head")[0].removeChild(b[c[e]])},
e=function(a,b,d){var c=document.createElement("script");c.type="text/javascript";c.setAttribute("ortcScriptId",b);k=!0;c.readyState?c.onreadystatechange=function(){if("loaded"==c.readyState||"complete"==c.readyState)k=!1,c.onreadystatechange=null,"undefined"!=typeof SOCKET_SERVER&&0>SOCKET_SERVER.indexOf("undefined")&&0>SOCKET_SERVER.indexOf("unknown_server")?d(!0,b):d(!1,b)}:c.onload=function(){k=!1;"undefined"!=typeof SOCKET_SERVER&&0>SOCKET_SERVER.indexOf("undefined")&&0>SOCKET_SERVER.indexOf("unknown_server")?
d(!0,b):d(!1,b)};c.onerror=function(){k=!1};c.src=a;document.getElementsByTagName("head")[0].appendChild(c)},d=function(){var a=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)};return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},s=function(c){null==b.sockjs&&(navigator&&(navigator.userAgent&&0<=navigator.userAgent.indexOf("PlayStation Vita"))&&(I="jsonp-polling"),b.sockjs=new SockJS(c+"/broadcast",I),b.sslFallback?b.xhrStreamingFallback||(b.validatedTimeoutId=setTimeout(function(){b.xhrStreamingFallback=
!0;K();N();E=p=!0;I="xhr-streaming"},5E3)):b.validatedTimeoutId=setTimeout(function(){b.sslFallback=!0;K();N();E=p=!0;I=0<=c.indexOf("https://")?"xhr-streaming":void 0;if(!("ActiveXObject"in window))if(g&&null!=g){if(0>g.indexOf("ssl/")){var a=g.search(/\/([\d.]*)\/$/);g=-1<a?g.substring(0,a+1)+"ssl/"+g.substring(a+1,g.length):g.substring(0,g.lastIndexOf("/")+1)+"ssl/"+g.substring(g.lastIndexOf("/")+1)}}else D=D.replace("http://","https://")},5E3),b.sockjs.onopen=function(){I=b.sockjs.protocol;t=
(new Date).getTime();M?A="":(A=R("ortcsession-"+b.appKey+"-s"),A||((A=R("ortcsession-"+b.appKey))||(A=O(16)),document.cookie="ortcsession-"+b.appKey+"-s="+A+"; path=/",R("ortcsession-"+b.appKey+"-s")||(A="")));var a=G?";"+b.getHeartbeatTime()+";"+b.getHeartbeatFails()+";":"";b.sockjs.send("validate;"+b.appKey+";"+b.authToken+";"+(u?u:"")+";"+A+";"+x+a)},b.sockjs.onclose=function(c){P(b);null!=b.sockjs&&(b.sockjs.close(),b.sockjs=null);r=null;if(1E3!=c.code){if(l&&(C=l=!1,I=void 0,null!=b&&null!=b.onDisconnected))b.onDisconnected(b);
z||(!q||q+a<(new Date).getTime())&&J()}else if(!p&&(C=l=!1,I=void 0,null!=b&&null!=b.onDisconnected))b.onDisconnected(b);E&&(b.connect(b.appKey,b.authToken),E=!1);p=!1},b.sockjs.onmessage=function(a){t=(new Date).getTime();var c=a.data,a=c.ch,c=c.m,d=/^(\w[^_]*)_{1}(\d*)-{1}(\d*)_{1}([\s\S.]*)$/.exec(c),e=null,f=1,g=1,k=!1;d&&0<d.length&&(d[1]&&(e=d[1]),d[2]&&(f=d[2]),d[3]&&(g=d[3]),d[4]&&(c=d[4]));if(e){B[e]||(B[e]={});B[e][f]=c;var d=0,l;for(l in B[e])d++;d==g&&(k=!0)}else k=!0;if(k){if(e){c="";
for(l=1;l<=g;l++)c+=B[e][l],delete B[e][l];delete B[e]}if(null!=b&&h[a]&&h[a].isSubscribed&&null!=h[a].onMessageCallback)h[a].onMessageCallback(b,a,c)}},b.sockjs.onortcsubscribed=function(a){t=(new Date).getTime();a=a.data;h[a]&&(h[a].isSubscribing=!1,h[a].isSubscribed=!0);if(null!=b&&null!=b.onSubscribed&&null!=a)b.onSubscribed(b,a)},b.sockjs.onortcunsubscribed=function(a){t=(new Date).getTime();a=a.data;h[a]&&(h[a].isSubscribed=!1);if(null!=b&&null!=b.onUnsubscribed&&null!=a)b.onUnsubscribed(b,
a)},b.sockjs.onheartbeat=function(){t=(new Date).getTime()},b.sockjs.onortcvalidated=function(a){var c=30;a.data&&(r=a.data);a.set&&(c=a.set);H(b);C=E=!1;l=!0;q=null;if(A&&(R("ortcsession-"+b.appKey+"-s")||(document.cookie="ortcsession-"+b.appKey+"-s="+A+"; path=/"),!R("ortcsession-"+b.appKey))){var a="ortcsession-"+b.appKey,d=A,e="";c&&(e=new Date,e.setTime(e.getTime()+6E4*c),e="; expires="+e.toGMTString());document.cookie=a+"="+d+e+"; path=/"}if(M){var a={},f;for(f in h)!0==h[f].subscribeOnReconnected&&
(h[f].isSubscribing||h[f].isSubscribed)?(h[f].isSubscribing=!0,h[f].isSubscribed=!1,d=f.indexOf(":"),c=f,e=null,0<d&&(c=f.substring(0,d+1)+"*"),r&&null!=r&&(e=r[c]?r[c]:r[f]),b.sockjs.send("subscribe;"+b.appKey+";"+b.authToken+";"+f+";"+e)):a[f]=f;for(var g in a)delete h[g];B={};null!=b&&null!=b.onReconnected&&(S(b),b.onReconnected(b))}else M=!0,null!=b&&null!=b.onConnected&&(S(b),b.onConnected(b))},b.sockjs.onortcerror=function(a){t=(new Date).getTime();var c=a.data,a=c.op,d=c.ch,c=c.ex?c.ex:c;f(b,
c);switch(a){case "validate":0>c.indexOf("busy")?(p=!0,H(b),E=!1,K()):(H(b),E=!1);break;case "subscribe":d&&h[d]&&(h[d].isSubscribing=!1);break;case "subscribe_maxsize":case "unsubscribe_maxsize":case "shutdown":H(b);E=!1;break;case "send_maxsize":d&&h[d]&&(h[d].isSubscribing=!1),K()}});return b.sockjs},f=function(a,b){if(null!=a&&null!=a.onException)a.onException(a,b)}};
